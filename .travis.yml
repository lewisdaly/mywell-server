sudo: required
language: nodejs
node_js:
  - 6
services:
  - docker
script:
  #TODO: git checkout submodules
  - docker-compose -f docker-compose.yml build
  - docker-compose -f docker-compose.yml pull --ignore-pull-failures
  # - docker-compose -f docker-compose.test.yml build
  # - docker-compose -f docker-compose.test.yml pull --ignore-pull-failures
  #TODO: run tests!
  # - docker-compose -f docker-compose.yml -f docker-compose.test.yml up -d sms-bot
  # - docker exec -it sms-bot bash -c "/usr/src/app/test/test.sh"
after_success:
  - if [ "$TRAVIS_BRANCH" == "docker-setup" ]; then
    docker login -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD";
    ./deployment/tools/tag_and_push_docker.sh all;
    fi
